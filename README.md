# 仮想SMTPサーバー

このプロジェクトは、開発・テスト用の仮想SMTPサーバーを提供します。実際のメール送信を行わずに、メール送信機能のテストや開発を行うことができます。

## 主な機能

- SMTPサーバーのエミュレーション
- 受信したメールのWebインターフェースでの表示
- メールの永続化（SQLiteデータベース）
- 添付ファイルのサポート
- 自動クリーンアップ機能（古いメールの自動削除）
- 高度な検索・フィルタリング機能
- キーワードハイライト表示
- レスポンシブUIデザイン

## 必要条件

- Python 3.7以上
- 必要なPythonパッケージ（requirements.txtに記載）

## インストール方法

1. 必要なパッケージをインストールします：
```bash
pip install -r requirements.txt
```

2. 環境変数を設定します：
`.env`ファイルを作成し、以下の設定を行います：
```
SMTP_SERVER=0.0.0.0
SMTP_PORT=25
SENDER_EMAIL=noreply@example.com
LOG_DIR=logs
DB_FILE=emails.db
RETENTION_DAYS=7
```

## 使用方法

1. サーバーを起動します：
```bash
python start.py
```

2. Webインターフェースにアクセスします：
ブラウザで `http://localhost:5000` を開きます。

3. メールの送信テスト：
任意のメールクライアントを使用して、設定したSMTPサーバー（localhost:25）にメールを送信します。

## 機能の詳細

### Webインターフェース

- 受信したメールの一覧表示
- メールの詳細表示（本文、HTML形式、添付ファイル）
- メールの削除機能
- 手動リフレッシュ機能
- 全メールのクリア機能
- 列ごとのフィルタリング機能
- 検索キーワードのハイライト表示
- 固定ヘッダーと固定ページネーション

### 高度な検索・フィルタリング機能

- 各列にフィルター入力欄を設置
- リアルタイム検索（入力しながら結果が更新）
- 検索キーワードを自動ハイライト表示
- 大文字・小文字を区別しない検索
- 部分一致検索をサポート

### UI改善点

- モダンで使いやすいインターフェース
- レスポンシブデザイン（様々な画面サイズに対応）
- テーブルヘッダーの固定表示（スクロール時も見出しが常に表示）
- ページネーションコントロールの固定表示
- カスタムCSSによるスタイリング

### データ管理

- メールはSQLiteデータベースに保存されます
- 設定された保持期間（デフォルト7日）を超えたメールは自動的に削除されます
- 添付ファイルは`attachments`ディレクトリに保存されます
- メールを削除すると、関連する添付ファイルも自動的に削除されます
- システムは古いメールをクリーンアップする際に、添付ファイルも一緒に削除します

### 添付ファイル管理

- 添付ファイルは`attachments`ディレクトリに一意のファイル名で保存されます
- ファイル名は`UUID_元のファイル名`の形式になります
- 添付ファイルは対応するメールとともに自動的に削除されるため、ディスク容量の管理が容易です
- Webインターフェースでは、添付ファイルをダウンロードできるボタンが表示されます
- 添付ファイルのコンテンツタイプは保持され、ダウンロード時に適切に処理されます

### ログ機能

- サーバーの動作ログは`logs`ディレクトリに保存されます
- ログファイルは日付ごとにローテーションされます

## 技術的詳細

- Flaskベースのウェブアプリケーション
- DataTablesによる高度な表機能
- mark.jsを使用した検索キーワードのハイライト機能
- CSSを外部ファイルに分離した整理された構造
- 非同期SMTPサーバー処理

## 注意事項

- このサーバーは開発・テスト目的のみに使用してください
- 本番環境での使用は推奨されません
- セキュリティ機能は最小限の実装となっています

## ライセンス

MIT License 